{% include 'navbar.html' %}
{% load static %}



<!-- INCLUDE STYLES AND FUNCTIONALITY ---------------------------------------------------------------------------------- -->

<head>
    <script src="{% static 'collected_JS_functions.js' %}"></script>
    <script src="{% static 'ajax_geneSymbol.js' %}"></script>
    <script src="{% static 'ajax_cellTypes.js' %}"></script>
    <script src="{% static 'papaparse.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static '/QueryStyleSheet.css' %}">

</head>


<!-- INITIATE INPUT FORM ---------------------------------------------------------------------------------- -->

<form id='geneID_forms' class='django_forms' method="POST" action="/geneQuery_search/" autocomplete="off" novalidate>
{% csrf_token %}

    <h1 class="queryDescription"><u>Look up genes in the database:</u></h1>

<br>
<!-- GET DB Version -------------------------------------------------------------------------------- -->

<div style="display: none;">  <!-- change to inline-block to make visible again -->
<h1 style="display: inline; " class="inputLabel">Database version:&nbsp;&nbsp;</h1>
<select style="display: inline;" name="db_version" id="db_version" >
<option selected='selected' value="db_version_1">Version 1</option>
</select></div>
<!--<br>-->
<!--<br>-->
<!--<br>-->
<!-- GET GENE FORMAT ---------------------------------------------------------------------------------- -->
<div style="display: inline-block;">
<h1 style="display: inline;" class="inputLabel">Gene nomenclature:&nbsp;&nbsp;</h1>
    <select style="display: inline;"  name="gene_format" id="gene_format" onchange="switchGeneIDField()" >
    <option selected='selected' value="id_format">ensemble ID</option>
    <option value="symbol_format">gene Symbol</option>
</select></div>

<br>
<br>
<!-- GET GENE ID ---------------------------------------------------------------------------------- -->

    <table class="geneQueryTable">
        <tr>

            <td height="100px" width="600px"><label for="geneID_numeric">
            <h1 class="inputLabel" id="geneHeader"> Ensemble gene ID:</h1>{% csrf_token %}
            <input width="90%" class='inputForm' id="geneID_numeric" name='geneID_numeric' type="email"  placeholder="E.g. ENSG00000139874, separate multiple IDs by comma" />
            <span class="error" aria-live="polite"></span>
            </label>
            <input class='inputForm' id="geneID_symbolic" name='geneID_symbolic' type="hidden"  placeholder="Type and select buttons on the right, deselect by clicking below" />
                <p  style="visibility:hidden;" class="selectionHeader" id="container_geneSymbolHeader"> Currently selected:</p>
            <div class ='selectedButtons'  id="container_geneSymbol"> </div>
            </td>

            <td width="900px" height="100px" >
                <div class="ajax_search_list" id="search-results-gene"></div>
            </td>
        </tr>
        <tr>
            <td><p class="selectionHeader" style="color:black;"><u>Or</u> upload a list of genes as csv:</p>
                <input class="inputForm" oninput="uploadCSV()" style="font-size:16px; border-left:none;" id="csv_upload" name="csv_upload" type="file" accept=".csv" ></td>
        </tr>

<!-- CELL TYPE SEARCH WITH BUTTONS ---------------------------------------------------------------------------------- -->

        <tr>
            <td height="150px" width="700px">
                <br>
                <div class="toggle">
                <h1 class='inputLabel' id="fieldname">Filter for cell types:</h1></div>
                {% csrf_token %}

                <input class='inputForm' type="text" id="search" name="search" placeholder="Leave empty to look up for all cell types" />
                <p class="selectionHeader tooltip" id="container_cellTypesHeader">Currently selected:<span class="tooltiptext_right">Deselect via button click below</span></p>
                <div class ='selectedButtons' id="container_cellTypes"> </div>
            </td>

            <td class="searchButtons">
                <div class="ajax_search_list" id="search-results"></div>
            </td>

        </tr>
    </table>


<!-- SUBMIT FORM ---------------------------------------------------------------------------------- -->
<input type="hidden" id="geneSymbol" name="geneSymbol"/>
<input type="hidden" id="cellTypes" name="cellTypes"/>
<input type="hidden" id="csvFile" name="csvFile"/>

<br>
<button type="button" class='ajax_search_list' id="exemplary_query" onclick="exemplaryGeneIDQuery()">Exemplary Query</button>

<input onclick='ButtonsToInput("container_geneSymbol", "geneSymbol"); ButtonsToInput("container_cellTypes", "cellTypes")' type="submit" name="Save" id="queryButton" value="Query Database" class="query_database" />


</form>


